Part 2: Testing Plan for Contributors
1. Unit Tests — Search Library
The search library already has two test files. Expand coverage:

Existing tests:

src/lib/search/__tests__/fuzzy-match.test.ts
src/lib/search/__tests__/query-classifier.test.ts
New tests to add:

src/lib/search/__tests__/semantic-search.test.ts — test semanticSearch() with category filtering, pricing filters, min/max results, empty queries, synonym expansion
src/lib/search/__tests__/semantic-mappings.test.ts — test expandSynonyms(), detectConcepts(), resolveCategory(), resolvePricing()
2. Component Tests — Critical User Flows
Create src/components/__tests__/ directory:

SearchModal.test.tsx

Opens on Cmd+K
Closes on Escape
Keyboard navigation (arrow up/down cycles through results)
Enter selects the highlighted result
Search input filters results
Focus trap between input and close button
Empty state displays correctly
Portal renders at document.body level
AIFilterResponse.test.tsx

Typewriter effect completes full message
Auto-dismiss fires after configured delay
Dismiss button clears message
New message resets typewriter
Timer cleanup on unmount (no act() warnings)
CategoryGrid.test.tsx

Renders all categories
Expanding a category shows subcategory row
Column count updates on resize
Subcategory row appears below correct grid row
3. Visual Regression Checklist
Manual checklist for PR review (document in a TESTING.md at project root):

Theme consistency (test BOTH light and dark mode):

 SearchModal renders correctly in light mode
 SearchModal renders correctly in dark mode
 SideNav tooltip is readable in both themes
 AIFilterResponse is readable in both themes
 Category buttons contrast is sufficient
 Resource cards have proper borders
 Table view header is properly styled
Responsive breakpoints (test at each):

 Mobile (375px) — single column cards, mobile search button visible
 Tablet (768px) — two column grid, search bar visible
 Desktop (1024px) — three column grid, full header
 Ultra-wide (2560px) — 3D canvas frames content properly
3D Canvas states:

 Initial load shows loader, then reveals universe
 Category filter zooms camera to cluster
 Search filter highlights matching nodes
 Hover shows tooltip following cursor
 Click navigates to resource detail
 Touch tap works on mobile devices
 Legend opens/closes properly
4. Performance Benchmarks — RESULTS (2026-02-09)

4a. Bundle Size Baseline (bun run build)

Build: vite v6.4.1 — ✓ 2708 modules transformed, built in 3.29s

| Chunk                | Raw         | Gzipped     | Status                          |
|----------------------|-------------|-------------|---------------------------------|
| vendor-three         | 1,198.73 KB | 348.35 KB   | Largest chunk (expected — Three.js) |
| index (app bundle)   | 485.12 KB   | 133.11 KB   | Main application code           |
| InspoCanvas          | 38.85 KB    | 12.38 KB    | 3D canvas component             |
| vendor-react         | 36.06 KB    | 13.14 KB    | ✅ Well under 200KB gzipped target |
| CSS                  | 51.94 KB    | 8.32 KB     | Single stylesheet               |
| **Total JS**         | **1,758.76 KB** | **506.98 KB** | **Baseline for contributors** |

Notes:
- vendor-three (348 KB gz) dominates the bundle. Tree-shaking THREE imports or switching to selective imports (e.g., three/examples/jsm) would be the biggest win for future optimization.
- vendor-react (13 KB gz) is minimal — React 19 is lean.
- No TypeScript errors during build.

4b. 3D Canvas Performance — Bug 2-5 Per-Frame Allocation Audit

⚠️ BLOCKER: Bug 2-5 fixes have NOT been merged to main.

The fixes exist on branch `opensesh/fix-group-a-bugs` (commit 8f3e2c1 "perf(canvas): hoist THREE.js allocations out of useFrame loops") but were never merged. All four per-frame allocation bugs are still present in InspoCanvas.tsx on main:

Bug 2 — InteractionController hot-loop allocations (STILL PRESENT)
  - Line 381: `new THREE.Matrix4()` allocated every frame
  - Line 382: `new THREE.Vector3()` allocated every frame
  - Line 396: `new THREE.Matrix4().makeRotationFromEuler(groupRotation)` allocated every frame inside instance loop
  - Impact: O(n) allocations per frame where n = visible resource count

Bug 3 — CursorLight per-frame allocation (STILL PRESENT)
  - Line 93: `new THREE.Vector3(mouse.current.x, mouse.current.y, 0.5)` allocated every frame
  - Impact: 1 Vector3 per frame (~60/sec)

Bug 4 — KeyboardController per-frame allocation (STILL PRESENT)
  - Line 157: `new THREE.Vector3()` (right) allocated every frame
  - Line 158: `new THREE.Vector3(0, 1, 0)` (up) allocated every frame
  - Line 162: `new THREE.Vector3()` (forward) allocated every frame
  - Impact: 3 Vector3s per frame (~180/sec) plus .clone() calls at lines 167, 170, 175, 178, 183, 186

Bug 5 — CameraController per-frame allocation (STILL PRESENT)
  - Line 595: `new THREE.Vector3().lerpVectors(...)` allocated every frame during camera animation
  - Impact: 1 Vector3 per frame during animation sequences

Result: GC spikes from object allocation CANNOT be confirmed as resolved until opensesh/fix-group-a-bugs is merged. DevTools Performance profiling should be re-run after merge.

Action required: Merge branch `opensesh/fix-group-a-bugs` to main, then re-run this benchmark.

4c. Additional Bug Fix Status (discovered during audit)

Verified on main:
  ✅ Bug 1  — SearchModal keyboard listener (fixed)
  ✅ Bug 6  — Subheader z-index + relative position (fixed)
  ✅ Bug 8  — AIFilterResponse timer leak (fixed, ref-tracked cleanup)
  ✅ Bug 12 — SearchModal semantic tokens (fixed)
  ✅ Bug 13 — Legend dropdown TODO comment (documented)

Still open on main:
  ❌ Bug 7  — Tooltip.tsx line 40: still uses hardcoded `backgroundColor: '#FFFFFF'`
  ❌ Bug 9  — Home.tsx: dismissAiResponse not wrapped in useCallback
  ❌ Bug 11 — InspoResourceTooltip.tsx: still uses `borderWidth: '2px'`
  ❌ Bugs 2-5 — InspoCanvas.tsx: per-frame allocations (fix on unmerged branch)
5. Accessibility Checklist
Keyboard navigation:

 Tab through all interactive elements in header
 Cmd+K opens search, Escape closes it
 Arrow keys navigate search results
 Enter selects a result
 Skip to main content link works on focus
 View mode buttons are keyboard accessible
 Legend button opens/closes with Enter/Space
Screen reader:

 Search modal has proper role="dialog" and aria-modal="true"
 aria-labelledby connects to visible heading
 View toggle buttons have aria-label and aria-current
 Skip link is available
 Resource count is announced (aria-live)
 Category buttons announce selected state
6. Cross-Browser Verification
Must test on:

Chrome (latest) — primary target
Firefox (latest) — CSS variable support, WebGL
Safari (latest) — backdrop-filter, WebGL quirks
Mobile Safari (iOS) — touch events, dvh units, viewport behavior
Chrome Android — touch events
Known risk areas:

backdrop-blur-sm / backdrop-blur-xl — Safari needs -webkit-backdrop-filter
h-dvh — dynamic viewport height, needs fallback for older browsers
WebGL/Three.js — shader compilation differences across GPU drivers
Web Speech API — only Chrome has full support (used in InspoChat voice recognition)
7. Critical User Flow Tests
Manual smoke tests before any release:

First visit flow: Load app → see loader → universe reveals → hover nodes → click resource → view detail → back to home
Search flow: Cmd+K → type query → arrow down → Enter → navigate to resource
Category filter flow: Click category button → universe zooms → AI response appears → auto-dismisses → click "All" to reset
View switching: 3D → Card → Table → 3D (verify no stale state)
Theme toggle: Switch dark → light → dark (verify all components theme correctly)
URL deep link: Navigate to /?display=table&category=Tools → verify table loads with Tools filter
Execution Order
Phase	Bugs	Est. Scope	Why This Order
1	2, 3, 4, 5	InspoCanvas.tsx only	Biggest perf impact, all same pattern
2	1, 12	SearchModal.tsx only	Most visible component, affects both themes
3	6, 9	Home.tsx only	Layout + callback fixes
4	7, 11	Tooltip + ResourceTooltip	Quick targeted fixes
5	8, 10	AIFilterResponse + CategoryGrid	Timer/resize cleanup
6	13	Home.tsx	Add TODO comment only
7	—	New test files + TESTING.md	Testing infrastructure for contributors
Verification
After all fixes, run these checks end-to-end:

bun run build — no TypeScript errors, build succeeds
bun test — all existing + new tests pass
bun dev — manual smoke test of all 6 critical user flows above
Open DevTools Performance → record 5s in 3D view → no GC spikes, steady 60fps
Toggle light/dark mode → every component themes correctly (SearchModal especially)
Resize browser narrow → wide → verify responsive behavior
Keyboard-only navigation → all interactive elements reachable